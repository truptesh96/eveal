!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=16)}([function(e,t){e.exports=window.wp.i18n},function(e,t){e.exports=window.wp.components},function(e,t){e.exports=window.wp.element},function(e,t){e.exports=ReactDOM},function(e,t){e.exports=window.wp.compose},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=((r=n(11))&&r.__esModule?r:{default:r}).default;t.default=a},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,t&&t.set(e,n);return n}(n(12)),o=(r=n(13))&&r.__esModule?r:{default:r};function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=s(this,l(t).call(this,e));var r=new Date;return n.state={decreseKey:0,percentages:[],startedTime:r.getTime()},e.decreaseTime&&window.setInterval((function(){var e=n.state.decreseKey;n.setState({decreseKey:e+1})}),1e3),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,e),n=t,(r=[{key:"componentDidUpdate",value:function(e){var t=this.state.percentages;if(this.props.percentage!==e.percentage){var n=new Date;t.push({percentage:this.props.percentage,time:n.getTime()})}}},{key:"render",value:function(){var e,t=this.props,n=t.percentage,r=t.initialText,a=t.completedText,c=t.calculateByAverage,i=t.formatter,u=t.decreaseTime,s=t.format,l=t.rollingAverageWindowSize,p=this.state,f=p.percentages,y=p.startedTime;if(n<=0||f.length<2)return r;if(n>=100)return a;var b=f[f.length-1];if(c)e=(b.time-y)/b.percentage*(100-b.percentage);else{var d=f[Math.max(0,f.length-(l||1)-1)];e=(b.time-d.time)/(b.percentage-d.percentage)*(100-n)}return isNaN(e)?r:(u&&(e-=(new Date).getTime()-b.time)<0&&(e=0),i?i(e):s?(0,o.default)(e,n,s):null)}}])&&u(n.prototype,r),a&&u(n,a),t}(a.Component);t.default=f,function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(f,"defaultProps",{calculateByAverage:!1,completedText:"Completed",decreaseTime:!0,format:"Completing in {value} {unit}",initialText:"Initializing",rollingAverageWindowSize:1})},function(e,t){e.exports=React},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e,t,n){var r=Math.ceil(e/1e3),a="second(s)",o=r;return r>31104e3?(o/=31104e3,a="year(s)"):r>2592e3?(o/=2592e3,a="month(s)"):r>86400?(o/=86400,a="day(s)"):r>3600?(o/=3600,a="hour(s)"):r>60&&(o/=60,a="minute(s)"),n.replace("{value}",Math.ceil(o).toString()).replace("{unit}",a).replace("{percentage}",Math.round(t).toString())}},function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(4),o=n(0),c=n(1);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var a=f(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p(this,n)}}function p(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y,b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,n,r,a=l(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=a.call(this,e)).logOutputTextarea=null,t.setLogOutputTextareaRef=function(e){return t.logOutputTextarea=e},t.scrollDownLogOutputTextarea=function(){t.logOutputTextarea&&(t.logOutputTextarea.scrollTop=t.logOutputTextarea.scrollHeight)},t}return t=c,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.isExpanded,r=t.shouldForceExpand,a=n||r;return React.createElement("div",{className:"types-technical-information"},React.createElement("div",null,React.createElement("label",{htmlFor:"logOutput",onClick:function(){return e.props.setState({isExpanded:!n})}},!r&&React.createElement("i",{"aria-hidden":"true",className:"fa "+(a?"fa-caret-up":"fa-caret-down")}),React.createElement("small",null," ",Object(o.__)("Technical information","wpcf")))),a&&React.createElement("div",null,React.createElement("textarea",{name:"logOutput",rows:20,readOnly:!0,ref:this.setLogOutputTextareaRef,value:this.props.logOutput})))}},{key:"componentDidUpdate",value:function(){this.scrollDownLogOutputTextarea()}}])&&u(t.prototype,n),r&&u(t,r),c}(r.Component),d=Object(a.compose)(Object(a.withState)({isExpanded:!1}))(b),m=1,h=2,g=3,w=4,v=5,S={error:v,warning:w,success:g};function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P(e);if(t){var a=P(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return T(this,n)}}function T(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=(x(y={},m,{className:"",color:""}),x(y,h,{className:"fa fa-spinner fa-spin fa-lg",color:""}),x(y,w,{className:"fa fa-exclamation-triangle fa-lg",color:"orange"}),x(y,v,{className:"fa fa-times fa-lg",color:"red"}),x(y,g,{className:"fa fa-check fa-lg",color:"#289d40"}),y),L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(o,e);var t,n,r,a=E(o);function o(){return O(this,o),a.apply(this,arguments)}return t=o,(n=[{key:"render",value:function(){var e=this.props,t=e.label,n=e.stepState,r=e.estimation,a=this.parseStepState(n);return React.createElement("li",null,React.createElement("span",{className:"types-step__list-row-label",style:{color:C[a].color}},t),React.createElement("span",{className:"types-step__list-row-estimation"},r),React.createElement("span",{className:"types-step__list-row-icon"},React.createElement("i",{className:C[a].className,style:{color:C[a].color}})))}},{key:"parseStepState",value:function(e){return e.isRunning?h:e.stepState}}])&&R(t.prototype,n),r&&R(t,r),o}(r.Component),k=function(e){return React.createElement(c.Icon,{size:e.size,icon:React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 121.98 121.98"},React.createElement("g",null,React.createElement("path",{fill:"#ed793e",d:"M117.72,91.31l3.85-3.85a1.23,1.23,0,0,0,0-1.83l-6.42-6.42a1.23,1.23,0,0,0-1.83,0l-3.85,3.85-3.85-3.85,3.85-3.85a1.23,1.23,0,0,0,0-1.83L103,67.1a1.23,1.23,0,0,0-1.83,0L97.36,71,93.42,67a1.23,1.23,0,0,0-1.83,0L67,91.59a1.23,1.23,0,0,0,0,1.83l27.69,27.69.46.46a1.23,1.23,0,0,0,1.83,0L121.57,97a1.3,1.3,0,0,0,0-1.83ZM114.88,94,117,96.08,96.08,117,71.51,92.41,92.6,71.32l4.77,4.77L102,71.41,105,74.35l-4.77,4.77,9.17,9.17,4.77-4.77,2.93,2.93-4.86,4.86Z"}),React.createElement("animate",{attributeName:"opacity",attributeType:"XML",values:"1; .2; 1",begin:"0.9s",dur:"1.2s",repeatCount:"indefinite"})),React.createElement("g",null,React.createElement("path",{fill:"#ed793e",d:"M93,57a1.23,1.23,0,0,0,1.83,0l24.57-24.57a1.3,1.3,0,0,0,0-1.83l-3.85-3.85,3.85-3.85a1.23,1.23,0,0,0,0-1.83L113,14.67a1.23,1.23,0,0,0-1.83,0l-3.85,3.85-3.85-3.85,3.85-3.85a1.23,1.23,0,0,0,0-1.83l-6.42-6.42a1.23,1.23,0,0,0-1.83,0L95.17,6.41,91.23,2.47a1.23,1.23,0,0,0-1.83,0L64.82,27a1.23,1.23,0,0,0,0,1.83L92.52,56.57ZM90.41,6.78l4.77,4.77,4.68-4.68,2.93,2.93L98,14.57l9.17,9.17L112,19l2.93,2.93L110,26.77l2.66,2.66,2.11,2.11L93.89,52.44,69.32,27.87Z"}),React.createElement("animate",{attributeName:"opacity",attributeType:"XML",values:"1; .2; 1",begin:"0.3s",dur:"1.2s",repeatCount:"indefinite"})),React.createElement("g",null,React.createElement("path",{fill:"#ed793e",d:"M55,19l-6.42-6.42a1.23,1.23,0,0,0-1.83,0l-3.85,3.85L39,12.61l3.85-3.85a1.23,1.23,0,0,0,0-1.83L36.45.5a1.23,1.23,0,0,0-1.83,0L30.76,4.36,26.82.41A1.23,1.23,0,0,0,25,.41L.41,25a1.23,1.23,0,0,0,0,1.83L28.1,54.51l.46.46a1.23,1.23,0,0,0,1.83,0L55,30.4a1.3,1.3,0,0,0,0-1.83l-3.85-3.85L55,20.86A1.23,1.23,0,0,0,55,19Zm-6.69,8.34,2.11,2.11L29.48,50.39,4.91,25.81,26,4.72l4.77,4.77,4.68-4.68,2.93,2.93-4.77,4.77,9.17,9.17,4.77-4.77,2.93,2.93-4.86,4.86Z"}),React.createElement("animate",{attributeName:"opacity",attributeType:"XML",values:"1; .2; 1",begin:"0s",dur:"1.2s",repeatCount:"indefinite"})))})},N=function(e){return React.createElement(c.Icon,{size:e.size,icon:React.createElement("svg",{viewBox:"0 0 804 804",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M595.092 274.151C595.092 267.561 589.82 262.289 583.23 262.289H533.804V212.863C534.463 206.931 529.19 201.659 523.259 201C522.6 201 522.6 201 521.941 201H439.564C433.633 200.341 428.361 205.613 427.702 211.545C427.702 212.204 427.702 212.204 427.702 212.863V262.289H378.276V212.863C378.935 206.931 373.663 201.659 367.731 201C367.072 201 367.072 201 366.413 201H283.377C277.446 200.341 272.174 205.613 271.515 211.545C271.515 212.204 271.515 212.204 271.515 212.863L270.856 262.948H220.112C214.181 262.289 208.908 267.561 208.249 273.492C208.249 274.151 208.249 274.151 208.249 274.81V591.138C207.59 597.069 212.863 602.341 218.794 603C219.453 603 219.453 603 220.112 603H577.299H583.23C589.161 603.659 594.433 598.387 595.092 592.456C595.092 591.797 595.092 591.797 595.092 591.138V274.151ZM243.177 567.413V295.899H304.466V235.928H342.689V297.217H460.653L461.312 235.269H498.876L498.217 298.535H532.486H559.505V567.413H243.177Z",fill:"#ED793E"}),React.createElement("path",{d:"M477.787 401.341L392.774 486.354C386.184 492.945 376.298 492.945 369.708 486.354L326.213 442.2C319.623 435.61 319.623 425.725 326.213 419.135C332.803 412.544 342.689 412.544 349.279 419.135L381.571 451.426L454.721 378.276C461.312 371.685 471.197 371.685 477.787 378.276C483.718 384.866 483.718 394.751 477.787 401.341Z",fill:"#ED793E"}))})},M=window.toolsetTypesDatabaseUpgradePageL10n;var D=n(5),U=n.n(D);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=W(e);if(t){var a=W(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return V(this,n)}}function V(e,t){return!t||"object"!==z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(c,e);var t,n,r,a=I(c);function c(){return B(this,c),a.apply(this,arguments)}return t=c,(n=[{key:"render",value:function(){return React.createElement(U.a,{percentage:this.getProgressPercentage(),initialText:Object(o.__)("estimating...","wpcf"),completedText:Object(o.__)("completed","wpcf"),format:"{value} {unit} "+Object(o.__)("remaining","wpcf")+" ({percentage}%)",calculateByAverage:!1,rollingAverageWindowSize:20})}},{key:"getProgressPercentage",value:function(){var e=this.props,t=e.currentSubstep,n=e.substepCount;return!t||t<1||!n||n<1?0:t/n*100}}])&&A(t.prototype,n),r&&A(t,r),c}(r.Component);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K(e,t,n,r,a,o,c){try{var i=e[o](c),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function X(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){K(o,r,a,c,i,"next",e)}function i(e){K(o,r,a,c,i,"throw",e)}c(void 0)}))}}function q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ne(e);if(t){var a=ne(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return te(this,n)}}function te(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var re=function(){return JSON.parse(JSON.stringify({currentStep:0,stepStates:Array(8).fill({isRunning:!1,stepState:m}),worstState:g,lastWorstState:g,isUpgradeRunning:!0}))},ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(u,e);var t,n,r,a,i=ee(u);function u(){return q(this,u),i.apply(this,arguments)}return t=u,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.supportForumURL,r=t.returnToUrl,a=t.returnToTitle,i=t.stepStates,u=t.logOutput,s=t.isUpgradeRunning,l=t.worstState,p=t.currentSubstep,f=t.substepCount,y=t.currentStep,b=!s&&l===g,m=!s&&l===w,h=!s&&l===v;return React.createElement("div",{className:"wrap types-wizard__container"},React.createElement("h1",{className:"wp-heading-inline"},Object(o.__)("Database Upgrade","wpcf")),React.createElement("p",{className:"wp-heading-description"},React.createElement("strong",null,Object(o.__)("Please don't leave this page.","wpcf")),React.createElement("br",null),React.createElement("br",null),Object(o.__)("Wait until the upgrade completes before making any changes on your site. This may take a few minutes.","wpcf")),React.createElement("div",{className:"types-wizard__body"},React.createElement("div",{className:"types-dialog__columns"},React.createElement("div",{className:"types-dialog__icon-area"},s&&React.createElement(k,{size:80}),!s&&React.createElement(N,{size:80})),React.createElement("div",{className:"types-dialog__content-area"},React.createElement("ol",{className:"types-step__list"},React.createElement(L,{label:Object(o.__)("Pre-migration site health check","wpcf"),stepState:i[0]}),React.createElement(L,{label:Object(o.__)("Dropping temporary database tables","wpcf"),stepState:i[1]}),React.createElement(L,{label:Object(o.__)("Creating new temporary database tables","wpcf"),stepState:i[2]}),React.createElement(L,{label:Object(o.__)("Migrating associations","wpcf"),stepState:i[3],estimation:s&&4===y&&React.createElement(Z,{currentSubstep:p,substepCount:f})}),React.createElement(L,{label:Object(o.__)("Enabling maintenance mode","wpcf"),stepState:i[4]}),React.createElement(L,{label:Object(o.__)("Renaming database tables","wpcf"),stepState:i[5]}),React.createElement(L,{label:Object(o.__)("Updating the database layer mode","wpcf"),stepState:i[6]}),React.createElement(L,{label:Object(o.__)("Disabling maintenance mode","wpcf"),stepState:i[7]})),b&&React.createElement(c.Notice,{status:"success",isDismissible:!1},React.createElement("p",null,Object(o.__)("The upgrade was successful!","wpcf ")),React.createElement("p",{dangerouslySetInnerHTML:{__html:this.getYouCanVisitTroubleshootingPageText()}})),m&&React.createElement(c.Notice,{status:"warning",isDismissible:!1},React.createElement("p",null,Object(o.__)("The upgrade has finished with some warnings. This may be caused by small inconsistencies in the database and it most probably has no impact on your site. Please check technical details for more information.","wpcf ")),React.createElement("p",{dangerouslySetInnerHTML:{__html:this.getYouCanVisitTroubleshootingPageText()}})),h&&React.createElement(c.Notice,{status:"error",isDismissible:!1},React.createElement("p",{dangerouslySetInnerHTML:{__html:Object(o.sprintf)(Object(o.__)("An error has occurred during the upgrade. We have tried to return to the state before the upgrade started. If you encounter any issues, please contact the %s with the copy of the technical details you will find below.","wpcf"),'<a href="'+n+'">'+Object(o.__)("Toolset support forum","wpcf")+"</a>")}}),React.createElement("p",{dangerouslySetInnerHTML:{__html:this.getYouCanVisitTroubleshootingPageText()}})),React.createElement(d,{logOutput:u,shouldForceExpand:!s&&l!==g}),React.createElement("div",{className:"types-wizard__btn-wrapper"},(b||m)&&React.createElement(c.Button,{isLarge:!0,className:"toolset-button toolset-button-primary",onClick:function(){return window.location.href=r}},Object(o.sprintf)(Object(o.__)("Great! Go back to %s","wpcf"),a)),h&&React.createElement(React.Fragment,null,!0===this.props.showRetryStepButton&&React.createElement(c.Button,{isLarge:!0,isPrimary:!0,onClick:function(){return e.retryUpgrade()}},Object(o.__)("Retry failed step","wpcf")),1==!this.props.showRetryStepButton&&React.createElement(c.Button,{isLarge:!0,isSecondary:!0,hidden:!0===this.props.retry,onClick:function(){return e.restartUpgrade()}},Object(o.__)("Restart Entire Migration","wpcf")),React.createElement(c.Button,{isLarge:!0,isTertiary:!0,onClick:function(){return window.open(n,"_blank")}},Object(o.__)("Go to support forum","wpcf"))))))))}},{key:"getYouCanVisitTroubleshootingPageText",value:function(){return e=Object(o.__)("You can also visit the %s page and remove the backup toolset_associations_old database table or perform a rollback to the state before the upgrade.","wpcf"),Object(o.sprintf)(e,'<a href="'+M.toolsetTroubleshootingURL+'" target="_blank">'+Object(o.__)("Toolset Troubleshooting","wpcf")+' <i class="fa fa-external-link " aria-hidden="true"></i></a>');var e}},{key:"startUpgrade",value:function(){this.updateSingleStepState(1,!0),this.doUpgrade(null,{}).then()}},{key:"retryUpgrade",value:function(){var e=this.props,t=e.nextState,n=e.newArgs,r=this.props,a=r.currentStep,o=r.lastWorstState,c=r.stepStates;c[a-1]={isRunning:!0,stepState:h},this.props.setState({stepStates:c,worstState:o,showRetryStepButton:!1}),this.doUpgrade(t,n)}},{key:"restartUpgrade",value:(a=X(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.setState(re());case 2:this.appendToLog(Object(o.__)("Retrying the database upgrade...","wpcf")),this.startUpgrade(),this.forceUpdate();case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"componentDidMount",value:function(){var e=this;WPV_Toolset.Utils.setConfirmUnload((function(){return e.props.isUpgradeRunning}),null,""),this.startUpgrade()}},{key:"ajaxCall",value:function(e,t){var n=this.props,r=n.ajaxActionName,a=n.nonce,o=new window.FormData;return o.append("action",r),o.append("wpnonce",a),o.append("migrationState",e),t.batch_size||(t.batch_size=this.props.batchSize),o.append("args",JSON.stringify(t)),window.fetch(window.ajaxurl,{method:"POST",body:o,credentials:"same-origin"})}},{key:"doUpgrade",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.ajaxCall(t||"",n).then((function(e){return e.ok?e.text().then((function(e){try{return JSON.parse(e)}catch(e){return{success:!1,message:Object(o.__)("An error has occurred while parsing the server response:","wpcf")+" "+e.message}}})):{success:!1,message:e.statusText,timeout:504===parseInt(e.status)}})).then((function(t){if(!("data"in t)||!("success"in t))return t.timeout&&4===e.props.currentStep?e.handleRetry(J({success:!1},t)):e.handleError(J({success:!1},t));if(!t.success)return e.handleError(t.data);var n=t.data,r=n.previousStepStatus,a=n.previousStepNumber,o=n.hasNextStep,c=n.nextStepNumber,i=n.nextState,u=n.message,s=n.args,l=n.currentSubstep,p=n.substepCount,f=n.wpnonce;return s.batch_size=e.props.batchSize,e.props.setState({currentSubstep:parseInt(l),substepCount:parseInt(p),nonce:f,nextState:i,newArgs:s,showRetryStepButton:!1,lastBatchSize:e.props.batchSize}),e.updateStateByUpgradeStep(r,a,u,c,o),o?e.doUpgrade(i,s):t}))}},{key:"handleError",value:function(e){this.updateStateByUpgradeStep(null,null,e.message?e.message:Object(o.__)("An error has occurred during the upgrade. Please contact our technical support.","wpcf"),null,!1,!1)}},{key:"handleRetry",value:function(e){if(!this.props.showRetryStepButton){if(!this.props.lastBatchSize||this.props.lastBatchSize>1){var t=this.props,n=t.nextState,r=t.newArgs,a=this.props.lastBatchSize?this.props.lastBatchSize:this.props.batchSize,c=Math.ceil(a/2);return r.batch_size=c,this.props.setState({lastBatchSize:c}),this.appendToLog(Object(o.__)("Retrying the last step with a smaller batch (%d)  due to gateway error...","wpcf").replace("%d",c)),this.doUpgrade(n,r)}this.props.setState({showRetryStepButton:!0,lastBatchSize:null})}this.handleError(e)}},{key:"updateStateByUpgradeStep",value:function(e,t,n,r,a){var o=this,c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],i=this.props.currentStep;this.appendToLog(n);var u=parseInt(t||i),s=c&&!!r&&u<r,l=a&&c,p=c?this.stateResponseToState(e):v;s?(X(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.updateSingleStepState(u,!1,p);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))().then(),this.updateSingleStepState(r,!0)):l?this.updateSingleStepState(u,!0,p):(this.updateSingleStepState(u,!1,p),this.props.setState({isUpgradeRunning:!1}))}},{key:"appendToLog",value:function(e){var t=this.props.logOutput;this.props.setState({logOutput:t+"\n> "+e})}},{key:"stateResponseToState",value:function(e){return e?S[e]:null}},{key:"updateSingleStepState",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.props,a=r.currentStep,o=r.worstState,c=r.stepStates,i=e-1,u=c[i].stepState,s=Math.max(n||u,u);c[i]={isRunning:t,stepState:s},this.props.setState({stepStates:c,currentStep:t?e:a,worstState:o<s?s:o,lastWorstState:o})}}])&&Q(t.prototype,n),r&&Q(t,r),u}(r.Component),oe=Object(a.compose)(Object(a.withState)(J({logOutput:"> "+Object(o.__)("The upgrade process is starting...","wpcf")},re())))(ae),ce=n(3),ie=n.n(ce);n(14);function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var se=window.toolsetTypesDatabaseUpgradePageL10n,le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"init",value:function(){ie.a.render(React.createElement(oe,{isWpmlActive:se.isWpmlActiveAndConfigured,ajaxActionName:se.ajaxActionName,nonce:se.nonce,batchSize:se.batchSize,supportForumURL:se.supportForumURL,returnToUrl:se.returnToUrl,returnToTitle:se.returnToTitle}),document.getElementById(se.anchorId))}}])&&ue(t.prototype,n),r&&ue(t,r),e}();document.addEventListener("DOMContentLoaded",(function(){(new le).init()}))}]);