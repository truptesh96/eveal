if(typeof SQ_DEBUG==="undefined")var SQ_DEBUG=false;(function($){"use strict";var clonedHeaderRow;$.fn.sq_auditsPages=function(){var $this=this;$(".sq_auditpages_refresh").on("click",function(){var $refresh=$(this);$refresh.addClass("fa-spin");$this.sq_getAuditPages();$this.on("sq_auditpages_loaded",function(){$refresh.removeClass("fa-spin")})});$(".sq_bulk_submit").on("click",function(){if($(".sq_bulk_input:checked").length>0){$(".sq_form_bulk_submit").submit()}else{alert("Select an audit first")}});$this.on("sq_auditpages_loaded",function(){$(".sq_save_ajax").find("input").on("change",function(){$(this).sq_ajaxCallListen()})})};$.fn.sq_getAuditPages=function(){var $this=this;var $sid=$.sq_getParam("sid");$this.addClass("sq_minloading");return $.post(sqQuery.ajaxurl,{action:"sq_auditpages_getaudit",sid:$sid?$sid:null,sq_nonce:sqQuery.nonce}).done(function(response){if(typeof response!=="undefined"){if(typeof response.html!=="undefined"){$("div.tooltip").hide();if(typeof response.stats!=="undefined"){$this.find(".sq_auditstatus_content").html(response.stats)}$this.find(".sq_auditpages_content").html(response.html);$(".sq_bulk_submit").on("click",function(){if($(".sq_bulk_input:checked").length>0){$(".sq_form_bulk_submit").submit()}else{alert("Select an audit first")}});$this.trigger("sq_auditpages_loaded");SQ_DEBUG&&console.log("sq_auditpages_loaded")}else{$("#sq_audits").trigger("error.refresh",response)}if(typeof response.error!=="undefined"){$.sq_showMessage(response.error,5e3).addClass("sq_error")}}else{$("#sq_audits").trigger("error.refresh");SQ_DEBUG&&console.log("no data received",response)}$this.removeClass("sq_minloading")}).fail(function(error){SQ_DEBUG&&console.log("no data received");$("#sq_audits").trigger("error.refresh",error);$this.removeClass("sq_minloading")},"json")};$.fn.sq_auditsPage=function(){var $this=this;$this.updateTableHeaders=function(){if($(".persist-area").length){if($(window).scrollTop()<$(".persist-area").first().offset().top-200){$("#sqd_toolbar").slideDown("fast");$("nav.navbar.fixed").slideDown("fast")}$(".persist-area").each(function(){var el=$(this),offset=el.offset(),scrollTop=$(window).scrollTop(),floatingHeader=$(".floatingHeader",this);if(scrollTop>=offset.top-80&&scrollTop<offset.top+el.height()){floatingHeader.css({visibility:"visible"});$(".sq_nav_item").removeClass("active");$(".sq_nav_item."+$(".floatingHeader:visible:last").data("id")).addClass("active");floatingHeader.slideDown("fast");floatingHeader.off("click").on("click",function(){$("html,body").animate({scrollTop:offset.top},1e3)});$("nav.navbar.fixed").slideUp("fast")}else if(scrollTop<offset.top-80){floatingHeader.slideUp("fast",function(){floatingHeader.css({visibility:"hidden",display:"none"})})}})}};$this.sticktothebottom=function(){var h=window.innerHeight;var window_top=$(window).scrollTop();$(".stickThis").each(function(){var $this=$(this);var top=$this.offset().top;var panelh=$this.outerHeight();var panelw=$this.outerWidth();if(window_top>=45){$this.addClass("stick");$this.css("max-width",panelw)}if(window_top<45){$(".stickThis").removeClass("stick")}})};$(window).scroll($this.updateTableHeaders).trigger("scroll");$(window).scroll($this.sticktothebottom);$this.sticktothebottom();$(".persist-area").each(function(){clonedHeaderRow=$(".persist-header",this);clonedHeaderRow.before(clonedHeaderRow.clone()).css("width",clonedHeaderRow.width()).addClass("floatingHeader")});$(".sq_nav_item").on("click",function(){$(".sq_nav_item").removeClass("active");$(this).addClass("active");$("html,body").animate({scrollTop:$("#sq_audit_tasks_header_"+$(this).data("id")).offset().top-80},1e3)});$(".sq_back_to_top").on("click",function(){var scrolltop=$(window).scrollTop();if(scrolltop>0)$("html,body").animate({scrollTop:0},1e3)})};$.fn.sq_inspectURL=function(){var $this=this;$this.find(".modal-body").addClass("sq_loading");$this.find(".modal-body").html("");var post_id=$this.attr("data-post_id");$this.modal("show");$.post(sqQuery.ajaxurl,{action:"sq_focuspages_inspecturl",post_id:post_id,sq_nonce:sqQuery.nonce}).done(function(response){if(typeof response!=="undefined"){if(typeof response.html!=="undefined"&&response.html){$this.find(".modal-body").html(response.html)}else{$this.find(".modal-body").html("Page could not load")}if(typeof response.error!=="undefined"){$.sq_showMessage(response.error,5e3).addClass("sq_error")}}$this.find(".modal-body").removeClass("sq_loading")}).fail(function(error){$this.trigger("error.refresh",error);$this.find(".modal-body").removeClass("sq_loading")},"json")};$(document).ready(function(){var $auditsdiv=$("#sq_audits");var $auditdiv=$("#sq_audit");if($auditsdiv.length>0){$auditsdiv.sq_auditsPages()}if($auditdiv.length>0){$auditdiv.sq_auditsPage()}$auditsdiv.on("error.refresh",function(){$.sq_showMessage("Couldn't load the data. <span class='sq_refresh' style='color: #f1d432; cursor:pointer;'>Please refresh</span>.",1e4).addClass("sq_error");$(".sq_refresh").on("click",function(){location.reload()})});$auditdiv.find(".sq_audit_completed_tasks").on("click",function(){$auditdiv.find("li.sq_audit_task_complete_1").show();$auditdiv.find("li.sq_audit_task_complete_0").hide()});$auditdiv.find(".sq_audit_incompleted_tasks").on("click",function(){$auditdiv.find(".sq_audit_task_complete_1").hide();$auditdiv.find(".sq_audit_task_complete_0").show()})})})(jQuery);